**Шифрование** – использование криптографических сервисов безопасности.

**Процедура шифрования** – преобразование открытого текста сообщения в закрытый.

Современные средства шифрования используют известные алгоритмы шифрования. Для обеспечения конфиденциальности преобразованного сообщения используются специальные параметры преобразования – ключи.

 **Ключ** – это конкретное (секретное или открытое) состояние некоторых параметров алгоритма криптографического преобразования данных, обеспечивающее выбор только одного варианта из всех возможных для данного алгоритма.

**Криптография** изучает методы и алгоритмы шифрования данных (правила построения и использования шифров), направленные на то, чтобы сделать эти данные бесполезными для злоумышленника.

**Методы криптографии** также используются для подтверждения подлинности источника данных и контроля целостности данных.

Криптография всегда являлась обязательным элементом безопасных информационных систем. Однако особое значение криптографические методы получили _с развитием распределенных открытых сетей, в которых нельзя обеспечить физическую защиту каналов связи._

**Криптоанализ** – это наука о раскрытии исходного текста зашифрованного сообщения без доступа к ключу.

В **шифре** всегда различают два элемента: алгоритм и ключ.

**Шифр** – совокупность обратимых преобразований множества открытых данных на множество зашифрованных данных, задаваемых ключом и алгоритмом криптографического преобразования.

**Криптостойкость** – основная характеристика шифра, которая определяет его стойкость к раскрытию методами криптоанализа, _определяется интервалом времени, необходимым для раскрытия шифра._

**Гаммирование** – процесс наложения по определенному закону гаммы шифра на открытые данные.

Под _гаммой_ шифра понимается псевдослучайная двоичная последовательность, вырабатываемая по заданному алгоритму, для шифрования открытых данных и расшифровывания зашифрованных данных.

**Имитозащита** – это защита системы шифрованной связи от навязывания ложных данных.

**Имитовставка** – это блок из m бит, который вырабатывается по определенному правилу из открытых данных с использованием ключа и затем добавляется к зашифрованным данным для обеспечения их имитозащиты.

# Системы криптографической защиты информации

- Задача средств криптографической защиты информации – преобразование информационных объектов с помощью некоторого обратимого математического алгоритма.
- Процесс **шифрования** использует в качестве входных параметров объект – открытый текст и объект – ключ, а результат преобразования — объект – зашифрованный текст.
- При **дешифровании** выполняется обратный процесс.
- Криптографическому методу в ИС соответствует некоторый специальный алгоритм. При выполнении данного алгоритма используется уникальное числовое значение – **ключ**.
- Знание ключа позволяет выполнить обратное преобразование и получить открытое сообщения.
- Стойкость криптографической системы определяется используемыми алгоритмами и степенью секретности ключа.

# Криптографические средства защиты данных

Для обеспечения защиты информации в распределенных информационных системах активно применяются криптографические средства защиты информации.

Сущность криптографических методов заключается в следующем:

![[Pasted image 20240420205215.png]]

# Использование средств криптографической  
защиты для предотвращения угроз ИБ

- **Обеспечение конфиденциальности данных.** Использование криптографических алгоритмов позволяет предотвратить утечку информации. Отсутствие ключа у «злоумышленника» не позволяет раскрыть зашифрованную информацию;
- **Обеспечение целостности данных.** Использование алгоритмов несимметричного шифрования и хэширования делает возможным создание способа контроля целостности информации.
- **Электронная цифровая подпись.** Позволяет решить задачу отказа от информации.
- **Обеспечение аутентификации.** Криптографические методы используются в различных схемах аутентификации в распределенных системах (Kerberos, S/Key и др.).

## Требования к системам  
криптографической защиты 

**1) Криптографические требования**

- Эффективность применения злоумышленником определяется **средней долей дешифрованной информации**, являющейся средним значением отношения количества дешифрованной информации к общему количеству шифрованной информации, подлежащей дешифрованию, и трудоемкостью дешифрования единицы информации, измеряемой Q числом элементарных опробований.
- Под **элементарными опробованиями** понимается операция над двумя n-разрядными двоичными числами. При реализации алгоритма дешифрования может быть использован гипотетический вычислитель, объем памяти которого не превышает M двоичных разрядов. За одно обращение к памяти может быть записано по некоторому адресу или извлечено не более n бит информации. Обращение к памяти по трудоемкости приравнивается к элементарному опробованию.
- За единицу информации принимается общий объем информации обработанной на одном средстве криптографической защиты в течении единицы времени. Атака злоумышленника является успешной, если объем полученной открытой информации больше некоторого заданного объема V.

**2) Требования надежности**

- Средства защиты должны обеспечивать заданный уровень надежности применяемых криптографических преобразований информации, определяемый значением допустимой вероятности неисправностей или сбоев, приводящих к получению злоумышленником дополнительной информации о криптографических преобразованиях.
- Регламентные работы (ремонт и сервисное обслуживание) средств криптографической защиты не должно приводить к ухудшению свойств средств в части параметров надежности.

**3) Требование по защите от несанкционированного доступа для средств криптографической информации в составе информационных систем**

В автоматизированных информационных системах, для которых реализованы программные или аппаратные средства  
криптографических защиты информации, при хранении и обработке информации должны быть предусмотрены  
следующие основные механизмы защиты:

- идентификация и аутентификация пользователей и субъектов доступа;
- управление доступом;
- обеспечения целостности;
- регистрация и учет.

**4) Требования к средствам разработки, изготовления и функционирования средств криптографической защиты информации.**  
Аппаратные и программные средства, на которых ведется разработка систем криптографической защиты информации, не должны содержать явных или скрытых функциональных возможностей, позволяющих:

- модифицировать или изменять алгоритм работы средств защиты информации в процессе их разработки, изготовления и эксплуатации;
- модифицировать или изменять информационные или управляющие потоки, связанные с функционированием средств;
- осуществлять доступ посторонних лиц к ключам идентификационной и аутентификационной информации;
- получать доступ к конфиденциальной информации средств криптографической защиты информации. 

##  Традиционные способы шифрования

- **Шифрование перестановкой** заключается в том, что символы шифруемого текста переставляются по определенному правилу в пределах некоторого блока этого текста.
- **Шифрование заменой (подстановкой)** заключается в том, что символы шифруемого текста заменяются символами того же самого алфавита (**простая замена**) или нескольких других алфавитов (**сложная замена**) в соответствии с заранее обусловленной схемой замены.
- **Шифрование гаммированием** заключается в том, что символы шифруемого текста складываются с символами некоторой случайной последовательности, именуемой гаммой шифра. Стойкость шифрования определяется в основном длиной (периодом) неповторяющейся части гаммы шифра.
- **Шифрование аналитическим преобразованием** заключается в том, что шифруемый текст преобразуется по некоторому аналитическому правилу (формуле).

# Современные способы шифрования

**Различают два основных способа шифрования:**

- **Симметричное шифрование,** иначе шифрование с закрытым ключом;
- **Ассиметричное шифрование**, иначе шифрование с открытым ключом;

![[Pasted image 20240420205251.png]]

При симметричном шифровании процесс зашифровывания и расшифровывания использует некоторый _секретный ключ._  
**При симметричном шифровании реализуются два типа алгоритмов:**

- Поточное шифрование (побитовое)
- Блочное шифрование (при шифровании текст предварительно разбивается на блоки, как правило не менее 64 бит)

**Выделяют следующие общие принципы построения шифров:**

- электронная кодовая книга (режим простой замены)

**ECB (Electronic Code Book);**

- сцепление блоков шифра (режим гаммирования с обратной связью)

**CBC (Cipher Block Chaining);**

- обратная связь по шифротексту

**CFB (Cipher Feed Back);**

- обратная связь по выходу (режим гаммирования)

**OFB (Output Feed Back).** 

В процессе шифрования и дешифрования используется один и тот же параметр – секретный ключ, известный обеим сторонам  
**Примеры стандартов симметричного шифрования:**

- ГОСТ 28147-89 “Системы обработки информации. Защита криптографическая. Алгоритм криптографического преобразования”
- DES (Data Encryption Standard)
- Blow Fish
- IDEA (International Data Encryption Algorithm)

**Достоинство симметричного шифрования -** Скорость выполнения преобразований  
**Недостаток симметричного шифрования** - Известен получателю и отправителю, что создает проблемы при распространении ключей и доказательстве подлинности сообщения

![[Pasted image 20240420205309.png]]

##  Алгоритм шифрования DES

- Стандарт шифрования DES (Data Encryption Standard)
- Алгоритм шифрования представляет собой блочный шифр, использующий подстановки, перестановки и сложения по модулю 2, с длиной блока 64 бита и длиной ключа 56 бит.
- Подстановки и перестановки, используемые в DES фиксированы.

**Основные этапы алгоритма шифрования**

 К блоку входного текста применяется фиксированная перестановка IP

 Для каждого цикла (всего 16) выполняется операция зашифровывания:

- 64 битный блок разбивается на две половины (левую x” и правую x’) по 32 бита
- Правая половина x’ разбивается на 8 тетрад по 4 бита. Каждая тетрада по циклическому закону дополняется крайними битами из соседних тетрад до 6-битного слова
- Полученный 48-битный блок суммируется по модулю 2 с 48 битами подключа, биты которого выбираются на каждом цикле специальным образом из 56 бит, а затем разбиваются на 8 блоков по 6 бит 
- Каждый из полученных на предыдущем шаге блоков поступает на вход функции фиксированного S-блока, которая выполняет нелинейную замену наборов 6- битных блоков тетрадами
- Полученные 32 бита подвергаются фиксированной перестановке, результатом которой является полублок Fi (x’)
- Компоненты правого зашифрованного полублока Fi (x’) суммируется по модулю 2 с компонентами левого полублока x” и меняются местами, т.е. блок (x”, Fi (x’)) преобразуется в блок (x”+Fi (x’),x”)

К блоку текста, полученному после всех 16 циклов, применяется обратная перестановка IP-1  
Результатом является выходной зашифрованный текст

## **Ассиметричное шифрование**

![[Pasted image 20240420205339.png]]

В ассиметричных алгоритмах шифрования ключи зашифровывания и расшифровывания всегда разные (хотя и связанные между собой).

Ключ зашифровывания является несекретным (открытым), ключ расшифровывания – секретным.

**Алгоритм шифрования RSA** (предложен Р.Ривестом, Э.Шамиром и Л.Адлманом) включает в себя:

- Пусть заданы два простых числа p и q и пусть n=pq, (n)=(p-1)(q-1). Пусть число e, такое что числа e и (n) взаимно простые, а d – мультипликативно обратное к нему, то есть edmod (n). Числа e и d называются открытым и закрытым показателями соответственно. Открытым ключом является пара (n,e) секретным ключом – d. Множители p и q должны сохраняться в секрете.
- Таким образом безопасность системы RSA основана на трудности задачи разложения на простые множители.

Кроме алгоритма RSA часто используемыми алгоритмами ассиметричного шифрования являются:

- **Алгоритм Эль-Гамаля** – использует простое число p, образующую группы g и экспоненту y=gx (mod p)
- **Алгоритм шифрования Месси-Омуры** – использует простое число p, такое что p-1 имеет большой простой делитель в качестве открытого ключа, секретный ключ определяется в процессе диалога между приемником и источником

В криптографических преобразованиях используется два ключа. Один из них несекретный (открытый) ключ  
используется для шифрования. Второй, секретный ключ для расшифровывания.  
**Примеры асимметричного шифрования:**

- RSA
- Алгоритм Эль-Гамаля

**Недостаток асимметричного шифрования**

- низкое быстродействие алгоритмов (из-за длины ключа и сложности преобразований)

**Достоинства:**

- применение асимметричных алгоритмов для решения задачи проверки подлинности сообщений, целостности и т.п.

## Сравнение симметричных и несимметричных алгоритмов шифрования

**Преимущества симметричных алгоритмов:**

- Скорость выполнения криптографических преобразований
- Относительная легкость внесения изменений в алгоритм шифрования

**Преимущества ассиметричных алгоритмов**

- Секретный ключ известен только получателю информации и первоначальный обмен не требует передачи секретного ключа
- Применение в системах аутентификации (электронная цифровая подпись)

##  Проверка подлинности

Криптографические методы позволяют контролировать целостность сообщений, определять подлинность источников данных, гарантировать невозможность отказа от совершенных действий.

**В основе криптографического контроля целостности лежат два понятия:**

- Хэш-функция;
- Электронная цифровая подпись.

##  Проверка целостности сообщений

Контроль целостности потока сообщений помогает обнаружить их повтор, задержку, переупорядочивание или утрату. Для контроля целостности сообщений можно использовать _хэш-функцию._

**Хэш-функция** – функция, преобразующая строку произвольной длины в строку фиксированной длины и удовлетворяющая  
следующим свойствам:

- Для каждого значения H(M) невозможно найти аргумент M – стойкость в смысле обращения;
- Для данного аргумента M невозможно найти аргумент M’,что H(M) = H(M’) – стойкость в смысле возникновения коллизий.

**Хэш-функция используется:**

- Для создания сжатого образа сообщения, применяемого в ЭЦП;
- Для защиты пароля;
- Для построения кода аутентификации сообщений.

##  Контроль подлинности

**Электронная цифровая подпись** выполняет роль обычной подписи в электронных документах для подтверждения подлинности сообщений – данные присоединяются к передаваемому сообщению, подтверждая подлинность  
отправителя сообщения.

При разработке механизма цифровой подписи возникает три задачи:

- создание подписи таким образом, чтобы ее невозможно было подделать;
- возможность проверки того, что подпись действительно принадлежит указанномувладельцу.
- предотвращение отказа от подписи.

## Алгоритм формирования  
электронной цифровой подписи 

При формировании цифровой подписи по классической схеме отправитель:

- Применяет к исходному тексту хэш-функцию;
- Дополняет хэш-образ до длины, требуемой в алгоритме создания ЭЦП;
- Вычисляет ЭЦП по хэш-образу с использованием секретного ключа создания подписи.

Получатель, получив подписанное сообщение, отделяет цифровую подпись от основного текста и выполняет проверку:

- Применяет к тексту полученного сообщения хэш- функцию;
- Дополняет хэш-образ до требуемой длины;
- Проверяет соответствие хэш-образа сообщения полученной цифровой подписи с использованием открытого ключа проверки подписи.

## Примеры алгоритмов формирования хэш-функции и ЭЦП 

Наиболее распространенные алгоритмы хэширования:

-  MD5 (Message Digest 5);
-  SHA (Secure Hash Algorithm);
-  ГОСТ Р34.11-94 “Информационная технология.

Криптографическая защита информации. Функция хэширования”;

 Алгоритмы формирования электронной цифровой подписи:

-  RSA (Rivest–Shamir–Adleman);
-  DSA (Digital Signature Algorithm);
-  ГОСТ Р34.10-94 “Информационная технология.

Криптографическая защита информации. Процедуры выработки и проверки электронной цифровой подписи на базе асимметричного криптографического алгоритма”

## Выбор алгоритмов аутентификации

При выборе протоколов аутентификации, необходимо определить, какой тип аутентификации требуется – односторонняя или двусторонняя, наличие доверенной стороны и т.д.

Параметры протокола аутентификации:

-  Тип алгоритма (симметричный, несимметричный);
-  Конкретный вид алгоритма;
-  Режим работы;
-  Процедура управления ключами;
-  Совместимость используемых алгоритмов.

##  Основные типы  
криптоаналитических атак

- **Фундаментальное правило криптоанализа**, впервые сформулированное голландцем А.Керкхоффсом еще в XIX веке заключается в том, что стойкость шифра (криптосистемы) должна определяться только секретностью ключа.
- **Принцип Керкхоффса (правило разработки криптографических систем)** состоит в том, что весь алгоритм шифрования, кроме значения секретного ключа, известен криптоаналитику. Это обусловлено тем, что криптосистема, реализующая семейство криптографических преобразований, обычно рассматривается как открытая система.

Такой подход отражает очень **важный принцип технологии защиты информации**: защищенность системы не должна зависеть от секретности чего-либо, что невозможно быстро изменить в случае утечки секретной информации.

- **Криптоаналитическая атака при наличии только известного шифртекста**

Криптоаналитик имеет только шифртексты C1, C2, ..., Ci нескольких сообщений, причем все они зашифрованы с использованием одного и того же алгоритма шифрования Ek. Работа криптоаналитика заключается в том, чтобы раскрыть исходные тексты M1, M2, ..., Mi по возможности большинства сообщений или, еще лучше, вычислить ключ K, использованный для шифрования этих сообщений, с тем, чтобы расшифровать и другие сообщения, зашифрованные этим  
шифром. Этот вариант соответствует модели внешнего нарушителя, который имеет физический доступ к линии связи, но не имеет доступ к аппаратуре шифрования и дешифрования.

- **Криптоаналитическая атака при наличии известного открытого текста**

**​​​​​​​**Криптоаналитик имеет доступ не только к шифртекстам C1, C2, ..., Ci и нескольких сообщений, но также к открытым текстам M1, M2, ..., Mi этих сообщений. Его работа заключается в нахождении ключа K, используемого при шифровании этих сообщений, или алгоритма расшифрования Dk любых новых сообщений, зашифрованных тем же ключом. причем все они зашифрованы с использованием одного и того же алгоритма шифрования Ek.

Возможность проведения такой атаки складывается при шифровании  стандартных документов, подготавливаемых по стандартным формам, когда определенные блоки данных повторяются и известны. Он также применим при использовании режима глобального шифрования, когда вся  информация на встроенном магнитном носителе записывается в виде шифртекста, включая главную корневую запись, загрузочный сектор, системные программы и пр.  При хищении этого носителя (или компьютера) легко установить, какая часть криптограммы соответствует системной информации и получить большой объем  известного исходного текста для выполнения криптоанализа.

- **Криптоаналитическая атака при возможности выбора** **открытого текста**

Криптоаналитик не только имеет доступ к шифртекстам C1, C2, …, Ci и  связанным с ними открытым текстам M1, M2, …, Mi этих сообщений, но и  может по желанию выбирать открытые тексты, которые затем получает в  зашифрованном виде. 

Такой криптоанализ получается более мощным по сравнению с  криптоанализом с известным открытым текстом, потому что криптоаналитик может выбрать для шифрования такие блоки открытого текста, которые  дадут больше информации о ключе. Работа криптоаналитика состоит в  поиске ключа K, использованного для шифрования сообщений, или  алгоритма рашифрования Dk новых сообщений, зашифрованных тем же  ключом. 

Этот вариант атаки соответствует модели внутреннего нарушителя. На  практике такая ситуация может возникнуть при вовлечении в криптоатаку лиц, которые не знают секретного ключа, но в силу своих служебных  полномочий имеют возможность использовать шифрование для передачи  своих сообщений.

- **Криптоаналитическая атака с адаптивным выбором  открытого текста** 

Криптоаналитик может не только выбирать открытый текст, который  затем шифруется, но и изменять свой выбор в зависимости от  результатов предыдущего шифрования. При криптоанализе с  простым выбором открытого текста криптоаналитик обычно может  выбирать несколько крупных блоков открытого текста для их  шифрования; при криптоанализе с адаптивным выбором открытого  текста он имеет возможность выбрать сначала более мелкий  пробный блок открытого текста, затем выбрать следующий блок в  зависимости от результатов первого выбора, и т.д.  

Это - особый вариант атаки с выбором открытого текста. Эта атака  предоставляет криптоаналитику еще больше возможностей, чем  предыдущие типы атак.

-  **Криптоаналитическая атака с использованием выбранного  шифртекста**

Криптоаналитик может выбирать для расшифрования различные  шифртексты и имеет доступ к расшифрованным открытым текстам.  Например, криптоаналитик получил досту к защищенному от  несанкционированного вскрытия блоку, который выполняет  автоматическое расшифрование. Работа криптоаналитика заключается в нахождении ключа. 

Этот тип криптоанализа представляет особый интерес для раскрытия  алгоритмов с открытым ключом.

-  **Криптоаналитическая атака методом полного перебора всех  возможных ключей** 

Эта атака предполагает использование криптоаналитиком известного  шифртекста и осуществляется посредством полного перебора всех  возможных ключей с проверкой, является ли осмысленным  получающийся открытый текст. 

Такой подход требует привлечения предельных вычислительных  ресурсов и иногда называется силовой атакой.

## **Заключение по шифрованию сообщений** 

**Шифрование информации** _требует определенных  затрат на его выполнение и не гарантирует 100- процентной надежности защиты от злоумышленника._ 

Поэтому всегда надо четко оценивать необходимость  применения определенного способа защиты информации  в конкретных ситуациях.