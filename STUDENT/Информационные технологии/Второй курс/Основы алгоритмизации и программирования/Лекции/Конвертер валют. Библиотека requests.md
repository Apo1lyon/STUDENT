#МоиЛекции 

В этом уроке вы:

- познакомитесь с API;
- создадите свой собственный конвертер валют.

Ваш конвертер валют сможет конвертировать валюты по актуальному курсу. Программа не будет иметь графической оболочки, управление будет из терминала. В дальнейшем вы сможете доработать эту программу самостоятельно.

### API (Application Programming Interface)

API (Application Programming Interface) — это интерфейс взаимодействия с программой, сайтом, сервисом. Пользоваться API может быть также просто, как и подключать устройства в порты ноутбука.

Нам понадобится API сайта для получения информации о валютах. Мы будем формировать специальный запрос в виде обычной ссылки. После отправки запроса, мы будем получать 
ответ от сайта. Этот ответ мы переведём в формат словаря (dict) Python. Словарь будет содержать информацию о валютах, которую мы будем выводить в удобном формате в 
терминал.

---
## Подготовка рабочего пространства

**Выполните следующие действия для подготовки к созданию конвертера валют**

1. Создайте папку для проекта;
2. Создайте в папке файл "main.py";
3. Откройте терминал (Win + R → Введите "cmd" → Ok);
4. Выполните команду pip install requests.

Последняя строка говорит об успешности установки этой библиотеки:

![[Pasted image 20240902163145.png]]

Выполнили все действия выше?
- Да, готов продолжать %%X%%
- Нет, еще в процессе

---
## Знакомство с API

Мы будем использовать API этого сайта: https://exchangerate.host. Сайт был выбран из-за полностью открытого API — вам не нужно регистрироваться для того, чтобы пользоваться им. Но главный плюс, количество запросов к API не ограничено.

Вы открыли сайт https://exchangerate.host в соседней вкладке?

---
## Документация API

Когда вы начинаете работать с API, вам нужно узнать:

- какие значения вы можете запросить у него;
- какие можете получить;
- в каком формате вы будете получать ответ.

Для ответа на эти вопросы разработчики API делают документацию.

**Откройте и изучите документацию на сайте.**

> Чтобы перейти к документации, нажмите на кнопку в правом верхнем углу "API documentation".

По горизонтали вы видите 7 вкладок. Каждая из этих вкладок представляет endpoint. Разработчики API решили разделить функциональность, чтобы API было удобнее использовать.

Первый endpoint позволяет работать с актуальным курсом валют, второй — конвертирует валюты, третий — позволяет посмотреть курс валют в определенный день.

Функция get в библиотеке requests выполняет тот же вид запроса, что и браузер, когда вы переходите по ссылке. Можно сказать, что get скачивает страничку по определенному адресу к вам на компьютер.

---
## Создание конвертера валют

Давайте получим информацию от первого endpoint.

Для этого нужно выполнить функцию get, она вернёт объект. Этот объект будет содержать отклик (response), информацию, полученную от API. У объекта response есть переменные и методы.

```python
import requests

url = "https://api.exchangerate.host/latest"

response = requests.get(url)

print(response.text)
```

В переменной text находится тело ответа.

**Введите код выше в интерпретатор и сравните его с информацией по ссылке, которая указана в коде. Ответьте на вопрос**

Совпадают ли данные

- Да, отличается только внешний вид %%X%%
- Нет, данные не совпали

---
## Создание конвертера валют

Да, результат в браузере и в терминале одинаковый. Браузер Firefox умеет представлять в удобном виде формат JSON. Формат JSON очень похож на словари Python. У объекта response есть метод, чтобы перевести JSON в словарь. Сырой JSON в Python — это всего лишь большая строчка, с ней неудобно работать.

**Выполните следующие действия и ответьте на вопрос ниже**

1. Введите код:

```python
import requests

url = "https://api.exchangerate.host/latest"

response = requests.get(url)

data = response.json()

print(data)
```

Вы вызвали метод json() у объекта. Он автоматически перевел в словарь всю информацию. Теперь с data можно работать;

2. Посмотрите на вывод в браузере, проследите цепочку ключей. В словаре есть два ключа — motd и rates. Нас интересует rates.

```python
import requests

url = "https://api.exchangerate.host/latest"

response = requests.get(url)

data = response.json()

rates = data["rates"]

print(rates["UAH"])
```

Из rates мы достали валюту по ее коду. Код выступает в роли ключа словаря. В данном случае, вывод — это число float;

3. Таким образом мы увидели курс евро к гривне. Узнайте курс своей валюты.

---
## Ссылки



---

| [[\|Предыдущая лекция]] | [[\|Следующая лекция]] |
| ----------------------- | ---------------------- |
